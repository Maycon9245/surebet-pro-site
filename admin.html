<!DOCTYPE html>

    // Atualiza estatísticas
    function atualizarEstatisticas() {
      const ativos = assinantes.filter(u => u.active).length;
      const inativos = assinantes.filter(u => !u.active).length;
      const faturamento = assinantes
        .filter(u => u.active)
        .reduce((sum, u) => sum + (u.plan === "Semanal" ? 29.90 : u.plan === "Mensal" ? 79.90 : 199.90), 0);
      const ltvMedio = assinantes.length > 0 ? faturamento / assinantes.length : 0;

      document.getElementById("ativos").textContent = ativos;
      document.getElementById("cancelamentos").textContent = inativos;
      document.getElementById("faturamento").textContent = `R$ ${faturamento.toFixed(2)}`;
      document.getElementById("ltv").textContent = `R$ ${ltvMedio.toFixed(2)}`;
    }

    // Gráfico
    let chart;
    function atualizarGrafico() {
      const ctx = document.getElementById('assinantesChart').getContext('2d');
      const labels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'];
      const data = [0, 0, 0, 0, 0, 0];
      const ativosPorMes = assinantes
        .filter(u => u.active)
        .map(u => new Date().getMonth() + 1); // Simulação: todos ativos agora

      ativosPorMes.forEach(mes => {
        if (mes <= 6) data[mes-1]++;
      });

      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Assinantes',
            data: data,
            borderColor: '#4caf50',
            backgroundColor: 'rgba(76, 175, 80, 0.2)',
            tension: 0.3,
            fill: true
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { labels: { color: '#fff' } }
          },
          scales: {
            x: { ticks: { color: '#aaa' } },
            y: { ticks: { color: '#aaa' } }
          }
        }
      });
    }

    // Inicializa
    renderizar();
  </script>
</body>
</html>
